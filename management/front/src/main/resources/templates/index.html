<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Graduation Project - 首页</title>
    <link rel="shortcut icon" href="/static/assets/images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/static/assets/images/favicon.ico" type="image/x-icon">
    <!-- Bootstrap -->
    <link href="http://cdn.bootstrapmb.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <link href="/static/assets/css/font-awesome.min.css" rel="stylesheet">
    <link href="/static/assets/css/magnific-popup.css" rel="stylesheet">
    <link href="/static/assets/css/jquery-ui.css" rel="stylesheet">


    <link href="/static/assets/css/animate.css" rel="stylesheet">
    <link href="/static/assets/css/owl.carousel.min.css" rel="stylesheet">


    <!-- Main css -->
    <link href="/static/assets/css/main.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>
<body>
<div id="app" v-loading="loading"
     element-loading-text="拼命加载中"
     element-loading-spinner="el-icon-loading">
    <div th:replace="head.html"></div>

    <!--Hero Section-->
    <section class="hero-area gray-bg">
        <div class="container">
            <div class="row">
                <div class="col-xl-4 col-lg-4 col-md-4 col-sm-6">
                    <div class="single-post">
                        <a href=""><img src="/static/assets/images/post/21.jpg" alt=""></a>
                        <div class="post-inside-content">
                            <div class="category-tag"><a href="" class="blue-bg-2">News</a></div>
                            <h2><a href="">Phasellus consequat rutrum</a></h2>
                            <div class="post-meta">
                                <a href="" class="author">Ridoy</a>
                                <a href="" class="date">September 4, 2019</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-4 col-lg-4 col-md-4 col-sm-6">
                    <div class="single-post">
                        <a href=""><img src="/static/assets/images/post/19.jpg" alt=""></a>
                        <div class="post-inside-content">
                            <div class="category-tag"><a href="" class="green-bg">Fashion</a></div>
                            <h2><a href="">Morbi leo lorem, cursus quis</a></h2>
                            <div class="post-meta">
                                <a href="" class="author">Ridoy</a>
                                <a href="" class="date">September 4, 2019</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-4 col-lg-4 col-md-4 col-sm-6">
                    <div class="single-post">
                        <a href=""><img src="/static/assets/images/post/3.jpg" alt=""></a>
                        <div class="post-inside-content">
                            <div class="category-tag"><a href="" class="blue-bg">Nature</a></div>
                            <h2><a href="">Ellentesque ultricies ullamcorper magna</a></h2>
                            <div class="post-meta">
                                <a href="" class="author">Ridoy</a>
                                <a href="" class="date">September 4, 2019</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-xl-3 col-lg-3 col-md-4 col-sm-6">
                    <div class="single-post">
                        <a href=""><img src="/static/assets/images/post/17.jpg" alt=""></a>
                        <div class="post-inside-content">
                            <div class="category-tag"><a href="" class="primary-bg">Food</a></div>
                            <h2><a href="">Nulla eget enim eget mauris aliquam</a></h2>
                            <div class="post-meta">
                                <a href="" class="author">Ridoy</a>
                                <a href="" class="date">September 4, 2019</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-3 col-lg-3 col-md-4 col-sm-6">
                    <div class="single-post">
                        <a href=""><img src="/static/assets/images/post/24.jpg" alt=""></a>
                        <div class="post-inside-content">
                            <div class="category-tag"><a href="" class="mint-bg">Football</a></div>
                            <h2><a href="">Quisque sed ex egestas, dignissim</a></h2>
                            <div class="post-meta">
                                <a href="" class="author">Ridoy</a>
                                <a href="" class="date">September 4, 2019</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-3 col-lg-3 col-md-4 col-sm-6">
                    <div class="single-post">
                        <a href=""><img src="/static/assets/images/post/11.jpg" alt=""></a>
                        <div class="post-inside-content">
                            <div class="category-tag"><a href="" class="yellow-bg">Music</a></div>
                            <h2><a href="">Nam suscipit luctus ante, vel iaculis</a></h2>
                            <div class="post-meta">
                                <a href="" class="author">Ridoy</a>
                                <a href="" class="date">September 4, 2019</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-3 col-lg-3 col-md-4 col-sm-6">
                    <div class="single-post">
                        <a href=""><img src="/static/assets/images/post/23.jpg" alt=""></a>
                        <div class="post-inside-content">
                            <div class="category-tag"><a href="" class="blue-bg-2">Politics</a></div>
                            <h2><a href="">Proin non arcu lacus. Etiam est quam</a></h2>
                            <div class="post-meta">
                                <a href="" class="author">Ridoy</a>
                                <a href="" class="date">September 4, 2019</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section><!--Hero Section-->

    <!--Content Section-->
    <section class="section-padding">
        <div class="container">
            <div class="row">
                <div class="col-xl-8 col-lg-8 col-md-8 col-sm-6">
                    <div class="row">
                        <div class="col-xl-12">
                            <div class="section-title">
                                <h2><a href="">官方发布</a></h2>
                            </div>
                        </div>
                        <div class="col-xl-12">
                            <div class="row single-post-2" v-for="(item, index) in adminPost4" v-if="index === 0">
                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12">
                                    <a :href="'/news/post/' + item.id"><img :src="item.image" alt=""
                                                                            style="height: 250px"></a>
                                </div>
                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12">
                                    <div class="post-inside-content">
                                        <div class="category-tag"><a class="primary-bg"
                                                                     :href="'/category/' + item.categoryId">{{item.categoryName}}</a>
                                        </div>
                                        <h2><a :href="'/news/post/' + item.id">{{item.title}}</a></h2>
                                        <p>{{item.content}}</p>
                                        <p>
                                            <el-link :underline="false" type="info" :href="'/news/post/' + item.id">
                                                {{String(item.likeCount)}}点赞 {{String(item.commentCount)}}评论
                                            </el-link>
                                        </p>
                                        <div class="post-meta">
                                            <span th:replace="userHover.html"></span>
                                            <a class="date">{{item.postTime}}</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-xl-4 col-lg-4 col-md-6 col-sm-12" v-for="(item, index) in adminPost4"
                             v-if="index != 0">
                            <div class="single-post-2">
                                <a :href="'/news/post/' + item.id"><img :src="item.image" alt=""
                                                                        style="width: 237px;height: 158px"></a>
                                <div class="post-inside-content">
                                    <h2><a :href="'/news/post/' + item.id">{{item.title}}</a></h2>
                                    <div class="post-meta">
                                        <span th:replace="userHover.html"></span>
                                        <a class="date">{{item.postTime}}</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                    <div class="row">
                        <div class="col-xl-12">
                            <div class="section-title">
                                <h2><a>最受欢迎</a></h2>
                            </div>
                        </div>
                    </div>

                    <div class="post-carousel owl-carousel mb-30">
                        <div class="row">
                            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12">
                                <div class="single-post" v-if="index === 0" v-for="(item, index) in likeMost4">
                                    <a :href="'/news/post/' + item.id"><img :src="item.image" alt=""
                                                                            style="width: 370px;height: 300px"></a>
                                    <div class="post-inside-content">
                                        <div class="category-tag"><a :href="'/category/' + item.categoryId"
                                                                     class="green-bg">{{item.categoryName}}</a>
                                        </div>
                                        <h2><a :href="'/news/post/' + item.id">{{item.title}}</a></h2>
                                        <div class="post-meta">
                                            <span th:replace="userHover.html"></span>
                                            <a class="date">{{item.postTime}}</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12">
                                <div class="single-list-post" v-if="index != 0" v-for="(item, index) in likeMost4">
                                    <div class="list-post-img">
                                        <a :href="'/news/post/' + item.id"><img :src="item.image" alt=""></a>
                                    </div>
                                    <div class="list-post-content">
                                        <a :href="'/category/' + item.categoryId"
                                           class="cl-mint">{{item.categoryName}}</a>
                                        <h4><a :href="'/news/post/' + item.id">{{item.title}}</a></h4>
                                        <h4><a :href="'/news/post/' + item.id">
                                            {{String(item.likeCount)}}点赞 {{String(item.commentCount)}}评论
                                        </a></h4>
                                        <div class="post-date">
                                            <span th:replace="userHover.html"></span>
                                            <a class="date">{{item.postTime}}</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-xl-12">
                            <div class="section-title">
                                <h2><a>最多评论</a></h2>
                            </div>
                        </div>
                    </div>
                    <!--                    <div class="post-carousel owl-carousel">-->
                    <div class="row">
                        <div class="col-xl-12">
                            <div class="row single-post-2" v-for="(item, index) in commentMost2" v-if="index === 0">
                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12">
                                    <a :href="'/news/post/' + item.id"><img :src="item.image" alt=""
                                                                            style="width: 370px;height: 245px"></a>
                                </div>
                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12">
                                    <div class="post-inside-content">
                                        <div class="category-tag"><a :href="'/category/' + item.categoryId"
                                                                     class="primary-bg">{{item.categoryName}}</a></div>
                                        <h2><a :href="'/news/post/' + item.id">{{item.title}}</a></h2>
                                        <p>{{item.content}}</p>
                                        <p>
                                            <el-link :underline="false" type="info" :href="'/news/post/' + item.id">
                                                {{String(item.likeCount)}}点赞 {{String(item.commentCount)}}评论
                                            </el-link>
                                        </p>
                                        <div class="post-meta">
                                            <span th:replace="userHover.html"></span>
                                            <a class="date">{{item.postTime}}</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xl-12">
                            <div class="row single-post-2" v-for="(item, index) in commentMost2" v-if="index === 1">
                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                                    <a :href="'/news/post/' + item.id"><img :src="item.image" alt=""
                                                                            style="width: 370px;height: 245px"></a>
                                </div>
                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                                    <div class="post-inside-content">
                                        <div class="category-tag"><a :href="'/category/' + item.categoryId"
                                                                     class="green-bg">{{item.categoryName}}</a>
                                        </div>
                                        <h2><a :href="'/news/post/' + item.id">{{item.title}}</a></h2>
                                        <p>{{item.content}}</p>
                                        <p>
                                            <el-link :underline="false" type="info" :href="'/news/post/' + item.id">
                                                {{String(item.likeCount)}}点赞 {{String(item.commentCount)}}评论
                                            </el-link>
                                        </p>
                                        <div class="post-meta">
                                            <span th:replace="userHover.html"></span>
                                            <a class="date">{{item.postTime}}</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--                    </div>-->

                    <div class="row">
                        <div class="col-xl-12">
                            <div class="section-title">
                                <h2><a href="">更多新闻</a></h2>
                            </div>
                        </div>
                        <div class="col-xl-12">
                            <div class="single-post-3" v-for="(item, index) in random5">
                                <div class="list-post-img">
                                    <img :src="item.image" alt="" style="width: 192px; height: 128px">
                                    <a :href="'/category/' + item.categoryId"
                                       :class="colorArr[Math.floor((Math.random()*colorArr.length))]">{{item.categoryName}}</a>
                                </div>
                                <div class="list-post-content">
                                    <h4><a :href="'/news/post/' + item.id">{{item.title}}</a></h4>
                                    <p>{{item.content}}</p>
                                    <p>
                                        <el-link :underline="false" type="info" :href="'/news/post/' + item.id">
                                            {{String(item.likeCount)}}点赞 {{String(item.commentCount)}}评论
                                        </el-link>
                                    </p>
                                    <div class="post-date">{{item.postTime}}</div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="col-xl-4 col-lg-4 col-md-4 col-sm-6">
                    <aside class="site-sidebar">
                        <div th:replace="sidebar.html"></div>
                    </aside>
                </div>
            </div>
        </div>
    </section><!--/Content Section-->

    <div th:replace="foot.html"></div>
</div>


<div th:replace="js.html"></div>
</body>
<script>
    new Vue({
        el: '#app',
        data() {
            return {
                colorArr: ["tag yellow-bg", "tag green-bg", "tag blue-bg", "tag primary-bg", "tag mint-bg"],
                categoryNewsCountParam: [],//分类下新闻数
                least4: [],//最新4条
                likeMost4: [], //最受欢迎4条
                commentMost2: [], //评论最多的2条
                random5: [], //随机5条新闻
                adminPost4: [], //admin4条新闻
                title: '',
                name: '',
                loading: false,
            };
        },
        created() {
            this.fetchData();
        },
        methods: {
            fetchData() {
                /**
                 * 得到每个分类下新闻数
                 */
                axios.get('/analyze/categoryNewsCount').then(response => {
                    this.categoryNewsCountParam = response.data.data;
                });
                /**
                 * 最新的4条新闻
                 */
                axios.get('/news/least4').then(response => {
                    this.least4 = response.data.data;
                });
                /**
                 * 最受欢迎4条新闻
                 */
                axios.get('/news/likeMost4').then(response => {
                    this.likeMost4 = response.data.data;
                });
                /**
                 * 评论最多2条新闻
                 */
                axios.get('/news/commentMost2').then(response => {
                    this.commentMost2 = response.data.data;
                });
                /**
                 * 随机5条新闻
                 */
                axios.get('/news/random5').then(response => {
                    this.random5 = response.data.data;
                });
                /**
                 * admin4条新闻
                 */
                axios.get('/news/adminPost4').then(response => {
                    this.adminPost4 = response.data.data;
                });
                if (this.isLogin()) {
                    this.name = localStorage.getItem("name");
                }

            },
            search() {
                window.location.href = '/news/search/front/' + this.title;
            },
            isLogin() {
                return localStorage.getItem('token') !== null;
            },
            logout() {
                axios.post('/front/logout', {access_token: localStorage.getItem('token')}, {
                    headers: {
                        "Authorization": 'Bearer ' + localStorage.getItem("token")
                    }
                }
                );
                localStorage.removeItem("token");
                localStorage.removeItem("name");
                window.location.reload();
            },
            toProfile() {
                window.location.href = '/user/' + localStorage.getItem("name") + '/' + localStorage.getItem("token");
            }
        }
    })
</script>
</html>